{"s":"meta","t":"SYS-003: logger usage and profiling rules for all code using IAdminLogger; ILogger must never be injected or called directly."}
{"s":"ns","t":"Required namespaces when logging: LagoVista.IoT.Logging.Loggers, LagoVista.Core.PlatformSupport, LagoVista.Core.Validation, System, System.Collections.Generic."}
{"s":"di","t":"Always inject IAdminLogger via constructor, store in private readonly field _adminLogger; no statics, no service locator, no ILogger injection, no property injection."}
{"s":"test_console","t":"Tests may create new AdminLogger(new ConsoleLogger()) (plus LagoVista.IoT.Logging.Utils). Console apps may create one AdminLogger + ConsoleLogger and register it as IAdminLogger in DI, then still use constructor injection everywhere else."}
{"s":"api","t":"Use only IAdminLogger surface: AddCustomEvent, AddException, Trace, StartTimedEvent/EndTimedEvent, TrackEvent, TrackMetric, AddError (string + ErrorCode), AddConfigurationError, AddMetric, LogInvokeResult (generic and non-generic). All calls go through _adminLogger."}
{"s":"enums","t":"LogLevel: UserEntryError, Error, UnhandledException, Warning, Message, StateChange, Verbose, TimedEvent, Metric, ConfigurationError, Authentication, Authorization. MetricType: Event or Aggregate."}
{"s":"tags","t":"Every tag must be [ClassName__MethodName] or [ClassName__MethodName__Activity]; tags appear on all tag parameters and at the start of Trace text, e.g. \"[UserService__CreateUser] - message\"."}
{"s":"kvp","t":"Use standard KVP keys: CorrelationId, TenantId, UserId, DeviceId, Operation, Status, ErrorCode, Endpoint, Provider, OrderId, EntityId. Prefer stringValue.ToKVP(\"Key\"); for non-strings use value.ToString().ToKVP(\"Key\"). Never pass null for params KVP arrays."}
{"s":"timing","t":"For non-trivial operations (HTTP calls, DB, workflows, jobs) use TimedEvent: var evt = _adminLogger.StartTimedEvent(area,description); try { ... } finally { _adminLogger.EndTimedEvent(evt); }. AddMetric/TrackMetric may be used to record numeric metrics."}
{"s":"progress","t":"For large/bulk loops (thousands of items), do not log each item; instead emit batched Trace progress every N items (e.g. 100) with processed, total, percent, elapsed, rough remaining time / ETA. These progress traces may be unconditional and tagged with a __Progress variant."}
{"s":"debug_noise","t":"DebugMode is read-only for agents; never set it. Optional extra diagnostics may be guarded with if(_adminLogger.DebugMode). Avoid noisy Trace logs, retry spam, and chatty per-step logs; prefer concise structured events and meaningful checkpoints."}
{"s":"safety","t":"Never log secrets: passwords, tokens, API keys, connection strings, keys, credit card data, auth headers. Be careful with PII: prefer IDs; mask or truncate email/phone/name if logged. Truncate large payloads and never dump full sensitive request bodies or config objects into logs."}
{"s":"invoke","t":"Always log failed InvokeResult / InvokeResult<T> with LogInvokeResult and relevant KVPs; optionally log successes for important workflows. Use AddConfigurationError for config problems and AddError for general business/system errors."}
{"s":"summary","t":"To comply with SYS-003, agents must: inject IAdminLogger only; use required namespaces; follow tag format; use ToKVP; use TimedEvent for profiling; batch progress logging; respect DebugMode as read-only; avoid sensitive data and large payloads; and apply these rules consistently in all generated logging code."}